---
layout:     post
title:      学习笔记：DFT笔记
subtitle:   Learning Notes
date:       2020-05-22
author:     MZ
header-img: img/post-bg-EVA.jpg
catalog: true
tags:
    - Learning Notes

---

# DFT笔记 

> 了解DFT

## 一、背景

可测性设计DFT（design for test）就是指为了使测试（制造测试）尽可能简单而有意识地在设计中加入一定附加逻辑地设计方法。

主要意义有三点：

1. 缩短产品进入市场时间，即TTM（time to market）：由于在设计时考虑了可测性设计，这就使得ATPG（automatic test pattern generaticn）可以进行，这样使测试模式的生成时间大大减少，从而使得整个的设计周期大大缩短，从而大大加快产品进入市场的时间。

   DFT => ATPG => 测试向量生成时间减少 => 设计周期缩短 => TTM缩短

2. 降低测试费用即COT（cost of test）：由于在设计时考虑了可测性设计，这就使得ATPG可以进行，而ATPG压缩测试模式，从而减少测试模式的数目，使得测试过程简单，从而降低测试费用。

   DFT => 测试向量数目减少 => 测试过程简单 => 测试费用降低

3. 提高产品质量：可测性设计可以使设计获得较高的故障覆盖率FC（Fault Coverage）。

   DFT => 高故障覆盖率

## 二、常用技术

### 1. 扫描（scan）设计

基于扫描设计是可测性设计中最常用的一种方法。它是指将电路中的普通触发器（flip-flops）替换为具有扫描能力的扫描触发器。扫描触发器最常用的结构是多路器扫描触发器，即它在普通触发器的输入端口加上一个多路器如图所示。当S=0时，触发器为正常的功能输入，而当S=1时，触发器为扫描输入。

![YbskN9.png](https://s1.ax1x.com/2020/05/21/YbskN9.png)

基于扫描设计分为两种：全扫描以及部分扫描。全扫描设计是指将电路中所有的触发器替换为扫描触发器并将它们连在一起构成扫描链，如图所示。图中，椭圆代表组合电路，长方形代表时序单元。左图为没有扫描链，右图为带有一条扫描链的全扫描设计。

![YbskN9.png](https://pics.images.ac.cn/image/5ec6480831187.html)

部分扫描设计则是将电路中的部分触发器替换为扫描触发器并将它们连在一起构成扫描链。部分扫描一般不用在那些关键的数据通路上，因为这些数据通路速度快，对延时的要求很高，而扫描替换增加了延时，故这些路径上的时序单元不进行扫描替换。

对于全扫描设计可以采用组合ATPG工具生成测试模式，而部分扫描设计只能采用时序ATPG 工具生成测试模式，而时序ATPG工具的运行时间要比组合ATPG工具运行的时间长几倍，且时序ATPG工具对内存的要求要大得多，一般是组合ATPG的三倍以上。

扫描设计大大增强了电路的可测性，因为当电路中生成扫描链后，扫描链上的所有时序单元的D端都是扫描可观的，与D相连的节点就是可观性节点，而数据输出端Q端是扫描可控的，与Q相连的节点就是可控性节点。

扫描设计最初是为了解决时序电路的测试而提出的一种可测性设计方法，它是将电路中的时序单元替换成具有扫描能力的时序单元并将它们连接起来形成链的过程。

扫描设计的优越性不仅因为它解决了时序电路的测试问题，而且扫描链为电路中的组合逻辑部分提供了激励的加载通路和响应的观测通路。在基于扫描设计的芯片进行 ATPG（automatic test pattern generatioh）时，扫描链上的每一个时序单元的数据输入端口D端作为一个外部输出端口以观测组合电路的响应，我们称之为`伪外部输出端口`（pseudo-PO）；而扫描链上的各个时序单元的数据输出端口Q端都作为一个外部输入端口用来加载激励向量，我们称之为`伪外部输入端口`（pseudo-PI），如下图所示。其中sdi为扫描数据输入端口，sdo为扫描数据输出端口，se为扫描允许端口，clk为时钟端口，椭圆代表组合逻辑电路，D为正常的数据输入端口，Q为正常的数据输出端口。

![image.png](https://i.loli.net/2020/05/21/i4slC9w8D5NadOn.png)

基于扫描设计可以显著地降低测试的复杂性，但是其不足在于使芯片面积略微增大，这不仅是因为扫描设计要将普通的触发器转换为扫描触发器的缘故，而且扫描设计大大增加了布线复杂性。

**扫描测试的时序**

扫描测试的时序如下图所示。SI为扫描输入，SO为扫描输出，SE为扫描允许。

![image.png](https://i.loli.net/2020/05/21/Zw14olxAjBsvG9e.png)

扫描测试的第一步是通过扫描移位（shift）操作将设计中的时序单元设置为期望的值，这个过程所需的时钟数就是内部最长的扫描链长度。这个过程SE=1，电路工作在扫描移动测试状态。

第二步是施加激励并抓取响应（capture）。这个过程SE=0，电路工作在正常的功能状态。

第三步是移出抓取的电路组合部分的响应。这个过程SE=1，电路工作在扫描移动测试状态。

值得注意的是当需要施加多个测试模式时，在前一个测试响应移出电路的同时就移入当前电路的测试激励。

### 2. 内建自测试（BIST）

内建自测试是可测性设计的另一种重要的方法。这种方法的基本思想是由电路自己生成测试向量，而不是要求外部施加测试向量，它依靠自身逻辑来判断所得到的测试结果是否是正确的，这样就大大降低了对测试设备的要求，而且它所要求“借用”的芯片封装引脚的数目要少得多。内建自测试的基本原理如图所示。

![image.png](https://i.loli.net/2020/05/21/1CGPel97jrXyna8.png)

BIST又分为逻辑内建自测试（LBIST）和存储器内建自测试（MBIST），MBIST又分为RAMBIST 以及ROMBIST。由于BIST要求电路自身生成测试向量，而随机逻辑的测试向量生成是非常复杂，故逻辑内建自测试在实际中应用有限，最常用的是MBIST。

#### 2.1 RAMBIST

由于RAM可读可写，因此我们要从读和写两个方面对它进行测试，其原理如图所示；又由于RAM结构规整致密，故其测试向量不像普通电路测试向量那样复杂，RAM测试的关键在于施加测试向量的时序上，最常用的是March算法。

![image.png](https://i.loli.net/2020/05/21/FTvNHhgQZUwuMb3.png)

#### 2.2 ROMBIST

ROM与RAM最大的不同之处是RAM可读可写，而ROM只读不可写，ROM中的信息是由制造厂家做好了的，因此ROMBIST与RAMBIST的最大不同就是前者没有向量生成电路，但由于ROM中的信息是多种多样，故其响应分析是非常复杂的，通常要用特征分析器首先对其响应进行压缩得出响应特征，然后针对特征进行比较，其结构原理图如下图所示。

![image.png](https://i.loli.net/2020/05/21/OUkrH2oGuiX4DN1.png)

ROMBIST的作用有两个：一方面是要验证存储在ROM中的数据是否正确；另一方面是确保能够准确读出存储器中的信息，而不出现破坏性的读操作，即在进行读操作时不会改变或毁坏数据。ROM测试也可以采用类似RAM测试的March算法。

### 3. 边缘扫描（Boundary Scan）

边缘扫描是欧美一些大公司联合成立的一个组织一一联合测试行动小组（JTAG）为了解决PCB板上芯片与芯片之间互连测试而提出的一种解决方案。由于该方案的合理性，它于1990年被IEEE采纳而成为一个标准，即IEEE1149.1。边缘扫描是在芯片的每一个输入输出引脚上增加一个存储单元，然后再将这些存储单元连成一个扫描通路，从而构成一条扫描链。由于这条扫描链分布在芯片的边缘，故称为边缘扫描。边缘扫描单元的原理如图所示。

![image.png](https://i.loli.net/2020/05/21/VKHm48yIPNgS3Qc.png)

边缘扫描单元有以下四个数据端口：di代表功能数据输入端口，do代表功能数据输出端口，sdi代表扫描数据输入端口，sdo代表扫描数据输出端口。

边缘扫描单元有四种操作：
1di->do这是正常的功能操作。
2sdi->sdo 这是测试时扫描移位操作。
3sdi->do 这是测试时将扫描移动数据施加到功能端口。
4di->sdo 这是测试时抓取功能端口的数据进入边缘扫描单元。

边缘扫描占用四个芯片引脚，即测试数据输入（TDI）、测试数据输出（TDO）、测试模式选择（TMS）以及测试时钟（TCK）。在正常的工作模式下，边缘扫描单元作为通常的输入输出器件；在测试模式下，测试向量将被施加到扫描输入、输出芯片的引脚。

![image.png](https://i.loli.net/2020/05/21/adSmzoiYn2sKQAy.png)

边缘扫描与基于扫描设计有着明显的区别，前者是在电路的输入输出端口增加扫描单元，并将这些扫描单元连成扫描通路；而后者是将电路中普通时序单元替换为具有扫描能力的时序单元，再将它们连成扫描通路。

### 4. DFT设计范畴的任务

概括地说，DFT可分为两个范畴，一个是设计范畴，另一个就是测试模式生成范畴。设计范畴的任务可以用下图表示。

![image.png](https://i.loli.net/2020/05/21/O6eH4wNgKzQJapk.png)

其中测试综合包括扫描综合、BIST综合，如果需要的话JTAG电路的综合。扫描综合的目标是故障覆盖率达到95%以上，扫描综合的工具是用SYNOPSYS的Test Compiler。





# 陈新武DFT讲义笔记

> https://wenku.baidu.com/view/2b59a50f76c66137ee0619af.html

### 基本概念

- 测试是通过控制和观察电路中的信号，确定电路是否正常工作的过程。因此，可控制性和可观察性是电路可测试性问题中最基本的两个概念。可测试性设计技术的目的就是试图增加电路节点的可控制性和可观测性，从而有效地、经济地完成芯片的生产测试。

- 可测试性技术的方法可分为功能点测试、基于扫描技术的结构化测试和内建自测试。

  - 功能点测试：

    增加测试点是提高电路可测试性最直接的方法。其基本方法是将电路内难于测试的节点引出，作为测试点，如果测试点直接用作系统的原始输入，则可以提高该电路节点的可控性，如果测试点用作系统的原始输出，则可以提高电路的可观察性。该方法的缺点是由于引脚数目的限制，所能引入的测试点数目非常有限。

    功能点测试技术的缺点在于它不能解决成品电路的测试筛选生成问题，只能用来辅助分析测试；另外，它需要在电路中每个测试点增加可控的输入端和可观察的输出端，因此而增加了附加的连线与IO端口，给后端的布局布线带来了较多的麻烦，也使得芯片面积的开销较大。

  - 扫描测试：

    扫描技术是指通过将电路中任一节点的状态移进或移出来进行测试定位的手段，其特点是测试数据的串行化。通过将系统内的寄存器等时序元件重新设计，使其具有可扫描性，测试数据从芯片端口经移位寄存器等组成的数据通路串行移动，并在数据输出端对数据进行分析，以此来提高电路内部节点的可控制性和可观察性，达到测试芯片内部节点的目的。扫描技术分为全扫描技术、部分扫描技术和边界扫描技术。

    全扫描技术就是将电路中所有的触发器用可扫描触发器替代，使得所有的触发器在测试的时候链接成一个移位寄存器链，称为扫描链。这样，电路在测试时就可以分成纯组合逻辑的测试和移位寄存器链的测试。电路中所有的状态可以直接从原始输入和输出端得到控制和观察。全扫描技术可以显著的减少测试生成的复杂度和测试费用，但这是以牺牲芯片面积和降低系统速度为代价的。

    部分扫描的方法是只选择一部分触发器构成扫描链，降低了扫描设计的芯片面积开销，减少了测试时间。其关键技术在于如何选择触发器。对部分扫描技术的研究主要在于如何减少芯片面积、降低对电路性能的影响，提高电路的故障覆盖率和减小测试矢量生成的复杂度等方面。

    边界扫描技术是各IC制造商支持和遵守的一种扫描技术标准，起先主要用于对印刷电路板的测试，它提供一个标准的测试接口简化了印刷电路板的焊接质量测试。它是在IC的输入输出端口处放置边界扫描单元，并把这些扫描单元依次连成扫描链，然后运用扫描测试原理观察并控制芯片边界的信号。边界扫描技术也可用于对系统芯片进行故障检测，但是由于这种测试观测方法要将所有的并行输入输出数据串行化，测试时间相当长，因此这种方法目前一般用于对板级系统的互连测试与电路板之间的互连测试。

  - 内建自测试（BIST.Built-In-Self-Test）：

    内建自测试技术对数字电路进行测试的过程可分为两个步骤：首先将测试信号发生器产生的测试序列施加到被测电路，然后由输出响应分析器检查被测电路的输出序列，以确定电路是否存在故障以及故障的位置。包含三部分：测试序列生成器、输出响应分析器和测试控制部分。

    在测试序列生成器中，有确定性生成、伪穷举测试生成和伪随机测试生成等几种方法。

    - 确定性测试方法：确定性测试方法是一种针对特定的电路故障进行测试的方法，虽然可以得到很高的故障覆盖率，但硬件开销大，仅在测试码个数较少的时候采用。

    - 伪穷举测试：伪穷举测试的方法是把所有可能输入都加以计算的测试方法。它的最大特点是故障覆盖率可以达到100%，但其计算量与输入端子呈幂次方关系，因此计算量很大。如果将电路分为多个原始输入变量互相独立的块，则测试数将大大减少。伪穷举法就是这样一种压缩测试向量的方法。伪穷举法也具有很高的故障覆盖率，但伪穷举法对电路进行划分比较困难，有相当的局限性。而且由于加入了附加硬件，可能对电路性能产生负面效应。

    - 伪随机测试：伪随机测试是一种广泛使用的测试方法，该方法可以对被测试电路产生大量的测试代码，而且硬件电路开销较小，同时具有较高的故障覆盖率。LFSR（Linear Feedback Shift Register，线性反馈移位寄存器）就是这样一种测试代码生成电路。

    实现输出响应分析的方法有ROM比较逻辑法、多输入特征寄存器法和跳变计数器法等。

    - ROM比较逻辑法是将正确的响应存储在芯片内的ROM中，在测试的时候，将其与测试响应进行比较，但这种方法会因为占用太多的芯片面积而毫无实用价值。
    - 多输入特征寄存器方法是将被测试电路中各节点的响应序列进行处理，得到与测试响应序列等长的特征字（Signature），然后与无故障电路节点的响应序列特征值进行比较，如果两者相同，则说明电路正常，否则表明被测试电路有故障存在。
    - 跳变计数器法是通过比较输出响应的跳变总数，来判断被测试电路是否正常工作，因此需要存储和比较跳变次数，从而使得所需要的存储空间与测试时间都得到大幅度的降低。但是后面两种方法是以牺牲故障覆盖率为代价的。

- 实现DFT的工具应该首推 Mentor公司。Fastscan可以用于全扫描逻辑电路的测试；Flextest则可以用于解决部分扫描设计问题；LBISTArchitect 则用来生成逻辑电路的BIST部分，适用于IP或宏模块的内建自测试设计；MBISTArchitect 可以用来实现存储器的BIST；BSDArchitect 可以用来生成边界扫描电路。
  Synopsys公司也有自己的DFT实现工具：DFT Compiler用来完成可测试性设计综合；TetraMAX用来生成ATPG（Auto Test Pattern Generation）测试向量；VERA Developers Kit则是测试平台开发和测试向量自动生成工具。

- 自动测试设备（ATE）：集成电路自动测试设备，即我们通常所说的 IC ATE（Automatic Test Equipment）
  通常是非常昂贵的测试平台（一般高于一百万美元）。ATE被看作一个模型，它具有：一定存储深度的多个通道（新型的ATE支持通道上有不同的工作频率），多个时钟产生器和多个电源输出端口。这些资源通过一个加载板上的插座提供给被测试芯片。ATE可能还具有另外一些资源与功能，例如：内存测试功能（MTF，Memory Test Functions）；模数和数模转换器；进行Idd和Iddq 测试的电流测试装置；用于验证或者同步输出时钟信号的频率计数器。

- ATE与仿真器的不同：仿真器可以在时钟驱动下工作，也可以没有时钟驱动。可以是基于周期的或事件的驱动，并且可以访问设计中任何信号、变量或者常量。由仿真器施加的波形可以被看作是理想的数学表示，未知的信号可以被看作状态“X”，高阻状态则被看作状态“Z”。ATE 则只能通过系统周边封装引脚进行操作。并且具有真实的信号延迟、时钟延迟、信号衰减、芯片的输出负载，以及实际工作时的热效应。测试仪也具有信号边缘布局的精确性（测试仪可以区分的最小测量值）、准确性（边缘布局的最小不确定性）和边缘斜率（上升和下降时间）[20]。

- 集成电路可测试性设计的挑战：

  1. 随着设计规模迅速提升，测试向量数目的急剧增加，迫切需要有效的测试向量压缩手段。压缩的同时要考虑解压，采用什么样的硬件电路能够实现所需要的解码与编码并具有较小的硬件开销和对电路性能的负面影响一直困扰着工业界和学术界；
  2. 深亚微米、纳米工艺不断涌现，器件特征尺寸越来越小，不断涌现出新的失效故障模型，串扰、电迁移和信号完整性问题更为突出；
  3. 芯片的工作速度不断提升，数字信号在高速的数字通道上表现出复杂的模拟特性，因而对测试仪提出了更高的要求，在许多情况下，往往必须进行实速测试；
  4. 模拟系统或者数模混合系统的可测试性设计非常困难，往往需要采用一套复杂的DSP系统来实现，而且成本极高，速度太慢，造成极大的硬件开销，因而不适合工业化生产；
  5. 集成电路在测试过程中的功耗会是正常工作状态功耗的2倍甚至更多，在测试的过程中要避免因为过热而烧坏芯片；
  6. 为了缩短上市时间和降低成本，集成电路的设计越来越多的采用基于IP的设计技术。但是，为了保护知识产权，IP核提供商往往不愿意过多的透漏IP核的具体实现细节。在这些情况下，集成工作者往往没有足够的信息来设计高质量的测试；
  7. 为了缩短芯片的测试时间，往往采用并行测试的方法，并行测试的基本问题是要对各个IP核进行调度，以便在最短的时间内完成测试。但是由于所考虑的问题具有复杂的数学模型，甚至有许多不确定的因素，造成并行测试的极端复杂性。

### 边界扫描

扫描技术是实现数字系统可测试性的关键技术，它包括边界扫描、全扫描、部分扫描。本章介绍边界扫描的实现方法，全扫描和部分扫描将在下一章介绍。

- 边界扫描技术一开始是为了测试芯片之间的简单互连（即导线直接连接）。由于系统芯片的设计是基于P核的设计，IP核之间的互连也可以采用边界扫描技术来实现。

- 边界扫描测试的基本原理如图3-1所示。符合边界扫描规则的集成电路除了原有的功能模块外，还要有边界扫描单元（BSC）和测试访问端口控制器（TAP Controller）。

  ![image.png](https://i.loli.net/2020/05/22/Q236useGtjXkWSU.png)

  图3-1中的移位寄存器单元插入到IC的核心逻辑与I/O管脚之间，以提供通过所有IC的一条串行测试数据通路。因为移位寄存器单元位于IC的边界处，所以这些单元被称为边界扫描单元（BSC，Boundary Scan Cell），由它们构成的移位寄存器称为边界扫描寄存器。串行测试数据的输入端被称为测试数据输入端（TDI），相应的输出端被称为测试数据输出端（TDO）。为了完成测试功能，相互连接的边界扫描单元必须具有数据移位、数据更新、数据捕获等功能，这些功能是由测试控制逻辑来控制的。测试控制逻辑由两条信号线驱动：测试方式选择（TMS）和测试时钟（TCK）。所以，整个边界扫描测试要求IC中至少有四个可利用的测试管脚，或将它们附加到其他的功能管脚上。

- 边界扫描测试技术的工作原理就是：JTAG测试仪利用一个四线测试接口，将测试数据以串行方式由TDI打入到边界扫描寄存器中，通过TMS发送测试控制命令，经TAP控制器控制边界扫描单元完成测试数据的加载和响应数据的捕获。最后，测试响应数据以串行扫描方式由TDO送出到JTAG测试仪，在那里，将捕获到的响应数据与期望的响应进行比较。四个管脚TMS、TCK、TDI和TDO被称为测试访问端口（TAP，Test Access Port），全部测试控制逻辑被称为TAP控制器。

- 许多系统使用模拟的、数字的以及数模混合的元件。各功能器件之间的连接不仅有简单的直接导线相连，也有电阻和电容这类耦合方式，如图3-2所示。

  ![image.png](https://i.loli.net/2020/05/22/RCQYjuVTSfzIsXP.png)

- IEEE1149.4边界扫描标准协议致力于模拟互连电路可测试性设计的规范化，是直接耦合电路可测试性设计标准EEE1149.1的扩展，它的基本思想与标准IEEE1149.1一样。

- IEEE 1149.4边界扫描标准的总体结构如图3-3所示，它向IEEE1149.1标准结构中加入了一些扩展结构，即模拟端口上的模拟边界模块ABM和连接在模拟测试访问端口上的测试总线接口电路。图3-3中所示的核心电路是一个模数混合电路，它分别与数字边界模块（DBM）和模拟边界模块（ABM）相连。图中画出了两个模拟管脚，在实际情况下，则可能有很多这样的管脚，对于每一个这样的管脚，则需要相同的连接方式。每一个ABM上都有3个电压值VH，VL和VG，它们是由ABM中的开关矩阵在测试过程中从相应的端子来获得的。VH是电路中最高的电平，VL是电路中最低的电平，VG则是稳定的参考电平。值得指出：这3个电平对于不同的管脚可能是不同的。在实际测试过程中，将VH和VL分别与VG进行比较，可以得到数字结果，然后将这个数字结果用到TBIC与ABM的控制电路部分，而它们的控制电路是连接在扫描链上的，这样，一个数字结果就可以和1149.1中的数字数据兼容。内部测试总线有两条，分别叫AB1和AB2。

  ![image.png](https://i.loli.net/2020/05/22/mJlPyQuaqIsnAHp.png)

  1149.4支持差分信号传输。当模拟测试访问端口采用差分形式的时候，就需要增加两个管脚，分别叫做AT1N与AT2N，它们需要另外一个TBIC和另外一对内部测试总线AB1N和AB2N。

  在需要进行模拟电路部分测试时，需要外加测试激励，AT1为激励信号输入，AT2为测试结果输出。测试总线接口电路（TBIC）的作用是在进行模拟测试的时候将AT1与AB1连通，AT2与AB2连通，当不需要进行模拟电路测试的时候，将它们断开。左下角的4个管脚TDI，TDO，TMS和TCK与1149.1中定义的一致，以便与它兼容。

  为了配合电容耦合的测试需要，IEEE 1149.4测试标准新增加了一个PROBE公开指令。对于数字电路，它的工作方式与采样指令SAMPLE相似。PROBE指令的作用主要体现在模拟电路测试中。当PROBE指令被选取时，模拟测试单元被设置成与核心电路相连，它可以从AT1端向电路提供激励信号，也可以在AT2端对电路的响应进行监控。

- IEEE Std 1149.5初衷是提供一个有较高利润和标准化的背板模块测试和维护界面，旨在用于将来自不同设计组和销售商的可测试模块集成到一个可测试和可维护的系统中去。该标准的接口协议和命令可以对于模块上的固件进行访间，支持IEEE Std 1149.1边界扫描标准。该标准支持单个模块的故障隔离和各个模块之间的互连测试。

  该总线协议标准化了一种测试和维护命令的通信方法，用于总线上各个子系统测试控制模块（MTM总线主模块）和其它模块（MTM总线从模块）之间的串行数据交换。MTM总线的内部可以包含其它的测试总线，它本身则作为全部测试和维护接口体系的一部分来实现。该标准的体系结构如图3-4所示。该协议的成功应用范例是波音777（boeing 777）。

  ![image.png](https://i.loli.net/2020/05/22/qgSsaOd5wBNEyjr.png)

  两个协议引脚对应关系：

  | 1149.5 | 1149.1 |
  | :----: | :----: |
  |  MMD   |  TDI   |
  |  MCTL  |  TMS   |
  |  MSD   |  TDO   |
  |  MCLK  |  TCK   |
  |  MPR   |  TRST  |

- IEEE Std 1149.6标准酝酿开始于2001年5月21日，起草者是安捷伦公司和Cisco公司组成的一个叫做特别工业工作组的组织。该工作组阐明了本标准，意在将它移交给IEEE，使之成为标准。该工作组的任务是：提出一种IC设计的方法，该方法支持鲁棒性的板级边界扫描测试，在信号通路中允许使用差分信号与交流耦合技术。该技术利用并且兼容现有的IEEE Std 1149.1他们的目标是提高IEEE Std1149.1的能力，以保持快速准确的检测和诊断系统中和电路板上的互连缺陷，尽管差分传送信号有故障掩盖效应，交流耦合传送信号有直流阻断效应。

  值得指出的是，在1149.6中采用的这种新方法，即使差模信号以单端信号方式发送，也能够较好的克服共模信号（直流电平）的干扰。在这个基本的思想下，本标准详细讨论了这种技术的应用。

- IEEE Std 1149.1-1999是边界扫描的第一个协议，它拉开了边界扫描技术推广与使用的序幕。IEEE Std 1149.4是对1149.1的一个补充，使得模拟耦合方式的测试成为可能。1149.6则在以上两个协议的基础上，扩充了指令集，增加了交流耦合通路和差分通路的测试能力。边界扫描协议IEEEStd 1149.5中定义的MTM总线结构，为扫描测试向网络化方面的发展奠定了基础。主模块和从模块之间的默契，为远程测试做下了铺垫。1149.6的提出，完善了混合系统测试的方法，使得电路中几乎所有的模块可以相互连接，统一在主测试模块的管辖之下。Agilent公司的芯片已经可以实现1149.6所要求的功能，完全支持1149.6的交流测试模式。

### 全扫描

- 可测试性设计的一般思想是构造扫描链，构造扫描链的关键是用可扫描寄存器替换原来的标准寄存器。一般情况下，可以使用的具有扫描功能的寄存器有四种类型，分别是：多路选择器型、专用时钟型、电平敏感型、辅助时钟型。下面逐一加以介绍。

- 多路选择器型的触发器

  这是一种主流类型。用带有选择器的触发器（或锁存器）单元替代标准的触发器（锁存器）单元，并将它们串在一起，形成扫描链，然后将ATPG施加到其上，就可以控制和观察电路内部节点处的信号。图4-1给出了采用多路选择器构成的可扫描触发器。图a为常规的D触发器示意图，图b为可扫描D触发器符号，图c为图b相对应的内部电路结构。

  由图中可以看出，具有扫描功能的触发器增加了两个输入端口：Scan_in和Scan_En。Scan_in 引脚用于接受扫描数据的输入，Scan_En用于扫描使能。在测试模式下，将测试向量打入寄存器的时候，将Scan_En 置为“1”；在正常工作模式下和测试模式下的非扫描状态，将其置为“0”。

  ![image.png](https://i.loli.net/2020/05/22/C9DfTbgteNyIq1m.png)

  采用多路选择器而增加的延迟表现在功能路径中，有较少的面积增加。一个带多路选择器的D触发器通常将一个标准D触发器的面积增加15%到30%；增加的I/O端口最少的可以只有一个Scan_En。在实际设计中，可能并不需要增加一个另外的I/O端口用于Scan_in 或者Scan_out，因为可以在设计中将这些引脚和功能引脚复用。

- 专用时钟扫描单元

  专用时钟控制的扫描方法是使用一个专用的、边沿触发的测试时钟来提供串行移位驱动。在功能模式下，系统时钟是活动的，系统数据被时钟打入单元电路。在测试移位过程中，测试时钟是活动的，扫描数据被打入该电路单元。电路符号如图4-2所示。图a为标准的D触发器，图b为专用时钟控制的可扫描单元。在这种结构中，相当于有两个D输入端，两个时钟输入端。在这种方式下，需要增加的测试引脚有：扫描输入、测试时钟、扫描输出（可以和输出功能引脚共用）。

  ![image.png](https://i.loli.net/2020/05/22/XLTZcVmW3bvF4Kq.png)

  专用时钟控制扫描方式的特征是：

  对电路性能影响可以忽略；面积的增加可以接受：一个专用时钟控制的扫描单元一般比普通的D触发器的面积增加15%--30%；支持这种扫描方式的工艺库具有触发器和锁存器两种等效单元；很适用于部分扫描设计：专用的测试时钟提供了一种机制，在扫描移位的过程中，可以很容易地保持非扫描单元的状态；支持带有异步置位和复位端的锁存器；典型的应用是具有边沿触发的设计风格。

- 电平敏感扫描设计

  常见的电平敏感扫描（LSSD扫描设计，Level Sensitive Scan design）单元有3种方式：单锁存器、双锁存器、专用时钟控制锁存器。

